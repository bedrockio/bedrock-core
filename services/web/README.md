# Bedrock Web

- [Components Documentation](src/components)
- [Utils Documentation](src/utils)
- [CRUD View Example](src/screens/Shops/index.js)
- [Analytics](src/utils/analytics/README.md)
- [Stores](src/stores/README.md)

## Directory Structure

- `package.json` - Configure dependencies
- `vite.config.js` - Bundling and build configuration
- `.env` - Enviroment variables
- `src/components` - Home of reuseable components
- `src/utils` - Home of specific JS helper utilities
- `src/index.html` - Main entrypoint into App UI
- `serve/static.js` - Static server
- `serve/dev.js` - Static server for development
- `dist/*` - Files generated by vite, incuding index.html. These are the assets
  that should be HTTP served

## Install Dependencies

Ensure Node.js version uniformity using Volta:

```
curl -sSLf https://get.volta.sh | bash
```

Install dependencies: (will install correct Node.js version)

```
yarn install
```

## Run

The following command serves all HTML/JS/CSS and watches all changes to
`src/*.js`

```bash
yarn start
```

UI is running at [http://localhost:2200/](http://localhost:2200/)

## Testing

We are using

- Tests MUST prioritize complex logic, edge cases, and critical flows.
- Tests MUST NOT over-cover trivial behavior.
- Tests MUST validate observable behavior, not implementation details.
- Tests MUST be colocated with the source file and use a .test.js suffix.

Run tests with:

```
yarn test
```

## Configuration

All configuration is done using environment variables. The default values in
`.env` can be overwritten using environment variables.

- `SERVER_HOST` - Host to bind to, defaults to `"0.0.0.0"`
- `SERVER_PORT` - Port to bind to, defaults to `2300`
- `SERVER_AUTH_PATH` - Basic Auth: Path to protect
- `SERVER_AUTH_USER` - Basic Auth: Username
- `SERVER_AUTH_PASS` - Basic Auth: Password
- `ENV_NAME` - Node environment `development`
- `APP_NAME` - Default product name to be used in views
- `API_URL` - URL for API defaults to `http://localhost:2300`
- `SENTRY_DSN` - Sentry error monitoring credentials

All config vars are available in the `serve/dev.js` and `serve/static.js`
server-side code. In the browser-side all variables are available as a global
object `window.__env_conf`.

## Frameworks Used

- [Mantine](https://mantine.dev/)
- [React Icons](https://react-icons.github.io/react-icons/)
- [Vite](https://vite.dev/)
- [React](https://facebook.github.io/react/)
- [Bedrock Router](https://github.com/bedrockio/router)
- [Prettier](https://prettier.io/)
- [Eslint](https://eslint.org/)
- [Lodash](https://lodash.com/)

## Other Features

- Full login/signup flow with separate dashboard and homepage router
- Uses Mantine as a rich UI element base
- Uses ES6 style React components
- Code hotswapping
- Static server

## Lodash

When using Lodash always used named imports. This will allow tree-shaking to
remove unneeded modules.

```js
import { omit } from 'lodash';
```

## API Documentation Portal

All API documentation is powered by Markdown. The API documentation can be
curated in `src/docs`. The menu and order of the guides can be configured in
`src/screens/Docs/index.js`.

Markdown has some extentions that allow you to pull in information via OpenAPI:

- `callHeading` - A method for showing a `method` + `path` summary of the API
  call
- `callParams` - A summary of the request body/query parameters
- `callResponse` - A summary of the response body
- `callExamples` - A list of examples on how to use the API call
- `callSummary` - All of the above
- `objectSummary` - Show attributes for a given rich object of `name`

For example, to generate a summary of API parameters for login, add this to the
Markdown:

```javascript
callParams({ method: 'POST', path: '/1/auth/login' });
```

## Updating Styles

see [Mantine's Theming](https://mantine.dev/theming/theme-object)
